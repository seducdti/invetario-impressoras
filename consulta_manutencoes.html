<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Consulta Manutenções</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
<header class="topbar">
    <h1>Consulta de Manutenções</h1>
    <nav>
        <a class="nav-link" href="index.html">Home</a>
        <a class="nav-link" href="cadastro_impressora.html">Cadastro Impressora</a>
        <a class="nav-link" href="manutencao.html">Cadastro Manutenção</a>
        <a class="nav-link" href="consulta_impressoras.html">Consultar Impressoras</a>
        <a class="nav-link active" href="consulta_manutencoes.html">Consultar Manutenções</a>
    </nav>
</header>

<main class="container">
<section class="card">
<h2>Lista de Manutenções</h2>
<div id="lista"></div>
</section>
</main>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAM_O0w1wWILJh0SEQMjavN9L2gRSRnbgA",
  authDomain: "inventario-impressoras-d9d58.firebaseapp.com",
  projectId: "inventario-impressoras-d9d58",
  storageBucket: "inventario-impressoras-d9d58.firebasestorage.app",
  messagingSenderId: "71103195224",
  appId: "1:71103195224:web:769d4e39ab8a76a042822d"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const lista = document.getElementById("lista");

async function carregar(){
    const snap = await getDocs(collection(db,"manutencoes"));

    if (snap.empty) {
        lista.innerHTML = "<p>Nenhuma manutenção cadastrada.</p>";
        return;
    }

    let html = "<ul>";

    snap.forEach(doc=>{
        const d = doc.data();
        html += `
          <li>
            <strong>${d.impressora}</strong><br>
            Problema: ${d.problema}<br>
            Escola: ${d.escola || "Não informado"}<br>
            Setor: ${d.setor || "Não informado"}<br>
            Entrada: ${d.entrada}<br>
            Saída: ${d.saida || "Não informada"}
          </li><hr>
        `;
    });

    html += "</ul>";
    lista.innerHTML = html;
}

carregar();
</script>


</body>
</html>
